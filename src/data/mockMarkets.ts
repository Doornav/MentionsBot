import { Market, Evidence, Forecast, Confidence } from "@/types/market";

// Helper to generate consistent dates
const now = new Date();
const hoursAgo = (h: number) => new Date(now.getTime() - h * 60 * 60 * 1000).toISOString();
const daysFromNow = (d: number) => new Date(now.getTime() + d * 24 * 60 * 60 * 1000).toISOString();

export const mockMarkets: Market[] = [
  {
    id: "PRES-2024-WINNER",
    ticker: "PRES24",
    title: "Will a Republican win the 2024 Presidential Election?",
    subtitle: "Electoral College Winner",
    category: "Presidential",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.52,
    marketProbabilityChange24h: 0.02,
    modelProbability: 0.48,
    modelProbabilityChange24h: -0.01,
    edge: -0.04,
    edgeDirection: "BUY_NO",
    confidence: "MEDIUM",
    volume24h: 2450000,
    openInterest: 15800000,
    lastUpdated: hoursAgo(0.5),
  },
  {
    id: "HOUSE-2024-GOP",
    ticker: "HOUSE24",
    title: "Will Republicans control the House after 2024?",
    subtitle: "House Majority",
    category: "Congressional",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.58,
    marketProbabilityChange24h: -0.01,
    modelProbability: 0.62,
    modelProbabilityChange24h: 0.03,
    edge: 0.04,
    edgeDirection: "BUY_YES",
    confidence: "HIGH",
    volume24h: 890000,
    openInterest: 5200000,
    lastUpdated: hoursAgo(1),
  },
  {
    id: "SENATE-2024-DEM",
    ticker: "SENATE24",
    title: "Will Democrats hold the Senate after 2024?",
    subtitle: "Senate Majority",
    category: "Congressional",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.35,
    marketProbabilityChange24h: -0.03,
    modelProbability: 0.38,
    modelProbabilityChange24h: 0.01,
    edge: 0.03,
    edgeDirection: "BUY_YES",
    confidence: "LOW",
    volume24h: 720000,
    openInterest: 4100000,
    lastUpdated: hoursAgo(0.75),
  },
  {
    id: "BIDEN-DROP-2024",
    ticker: "BIDROP",
    title: "Will Biden withdraw from 2024 race before convention?",
    subtitle: "Candidate Withdrawal",
    category: "Presidential",
    expirationDate: daysFromNow(45),
    status: "active",
    marketProbability: 0.15,
    marketProbabilityChange24h: 0.05,
    modelProbability: 0.22,
    modelProbabilityChange24h: 0.08,
    edge: 0.07,
    edgeDirection: "BUY_YES",
    confidence: "MEDIUM",
    volume24h: 1850000,
    openInterest: 8900000,
    lastUpdated: hoursAgo(0.25),
  },
  {
    id: "TRUMP-CONVICTION",
    ticker: "TCONV",
    title: "Will Trump be convicted before Election Day?",
    subtitle: "Legal Proceedings",
    category: "Legal",
    expirationDate: daysFromNow(150),
    status: "active",
    marketProbability: 0.72,
    marketProbabilityChange24h: 0.01,
    modelProbability: 0.68,
    modelProbabilityChange24h: -0.02,
    edge: -0.04,
    edgeDirection: "BUY_NO",
    confidence: "HIGH",
    volume24h: 3200000,
    openInterest: 12400000,
    lastUpdated: hoursAgo(0.5),
  },
  {
    id: "PA-2024-WINNER",
    ticker: "PA24",
    title: "Will Republicans win Pennsylvania in 2024?",
    subtitle: "Swing State",
    category: "State",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.48,
    marketProbabilityChange24h: 0.01,
    modelProbability: 0.45,
    modelProbabilityChange24h: -0.02,
    edge: -0.03,
    edgeDirection: "BUY_NO",
    confidence: "LOW",
    volume24h: 520000,
    openInterest: 2800000,
    lastUpdated: hoursAgo(2),
  },
  {
    id: "GA-2024-WINNER",
    ticker: "GA24",
    title: "Will Republicans win Georgia in 2024?",
    subtitle: "Swing State",
    category: "State",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.55,
    marketProbabilityChange24h: 0.02,
    modelProbability: 0.58,
    modelProbabilityChange24h: 0.04,
    edge: 0.03,
    edgeDirection: "BUY_YES",
    confidence: "MEDIUM",
    volume24h: 480000,
    openInterest: 2500000,
    lastUpdated: hoursAgo(1.5),
  },
  {
    id: "MI-2024-WINNER",
    ticker: "MI24",
    title: "Will Democrats win Michigan in 2024?",
    subtitle: "Swing State",
    category: "State",
    expirationDate: daysFromNow(180),
    status: "active",
    marketProbability: 0.52,
    marketProbabilityChange24h: -0.01,
    modelProbability: 0.55,
    modelProbabilityChange24h: 0.02,
    edge: 0.03,
    edgeDirection: "BUY_YES",
    confidence: "MEDIUM",
    volume24h: 410000,
    openInterest: 2200000,
    lastUpdated: hoursAgo(1),
  },
  {
    id: "FED-RATE-CUT-JUN",
    ticker: "FEDCUT6",
    title: "Will Fed cut rates by June FOMC meeting?",
    subtitle: "Monetary Policy",
    category: "Economic",
    expirationDate: daysFromNow(60),
    status: "active",
    marketProbability: 0.28,
    marketProbabilityChange24h: -0.05,
    modelProbability: 0.22,
    modelProbabilityChange24h: -0.03,
    edge: -0.06,
    edgeDirection: "BUY_NO",
    confidence: "HIGH",
    volume24h: 680000,
    openInterest: 3100000,
    lastUpdated: hoursAgo(0.5),
  },
  {
    id: "GOV-SHUTDOWN-2024",
    ticker: "GOVSHUT",
    title: "Will there be a government shutdown in Q1 2024?",
    subtitle: "Fiscal Policy",
    category: "Economic",
    expirationDate: daysFromNow(30),
    status: "active",
    marketProbability: 0.35,
    marketProbabilityChange24h: 0.08,
    modelProbability: 0.42,
    modelProbabilityChange24h: 0.12,
    edge: 0.07,
    edgeDirection: "BUY_YES",
    confidence: "MEDIUM",
    volume24h: 920000,
    openInterest: 4500000,
    lastUpdated: hoursAgo(0.25),
  },
];

export const mockEvidence: Evidence[] = [
  {
    id: "ev-001",
    marketId: "BIDEN-DROP-2024",
    source: "New York Times",
    sourceType: "news",
    sourceCredibility: 0.95,
    url: "https://nytimes.com/example",
    title: "Senior Democrats Express Private Concerns About Biden's Debate Performance",
    summary: "Multiple senior Democratic officials have privately expressed concerns about President Biden's debate performance, with some discussing contingency plans, according to people familiar with the conversations.",
    publishedAt: hoursAgo(2),
    direction: "YES",
    strength: "STRONG",
    relevanceScore: 0.95,
    author: "Maggie Haberman",
    isVerified: true,
  },
  {
    id: "ev-002",
    marketId: "BIDEN-DROP-2024",
    source: "Biden Campaign",
    sourceType: "official",
    sourceCredibility: 0.9,
    url: "https://joebiden.com/statement",
    title: "Biden Campaign Reaffirms Commitment to 2024 Race",
    summary: "The Biden campaign released a statement reaffirming the President's commitment to running in 2024, dismissing speculation about withdrawal as 'unfounded.'",
    publishedAt: hoursAgo(4),
    direction: "NO",
    strength: "MEDIUM",
    relevanceScore: 0.88,
    isVerified: true,
  },
  {
    id: "ev-003",
    marketId: "BIDEN-DROP-2024",
    source: "@NateSilver538",
    sourceType: "twitter",
    sourceCredibility: 0.85,
    url: "https://twitter.com/example",
    title: "Silver: 'Probability of withdrawal higher than markets suggest'",
    summary: "Polling analyst Nate Silver argues that markets are underpricing the probability of Biden withdrawal, citing historical precedent and current polling trajectory.",
    publishedAt: hoursAgo(1),
    direction: "YES",
    strength: "MEDIUM",
    relevanceScore: 0.82,
    author: "Nate Silver",
    isVerified: true,
  },
  {
    id: "ev-004",
    marketId: "TRUMP-CONVICTION",
    source: "Reuters",
    sourceType: "news",
    sourceCredibility: 0.92,
    url: "https://reuters.com/example",
    title: "Judge Sets Trial Date for Trump Hush Money Case",
    summary: "A New York judge has scheduled the trial in Trump's hush money case for March 25, making it likely to conclude before the November election.",
    publishedAt: hoursAgo(6),
    direction: "YES",
    strength: "STRONG",
    relevanceScore: 0.91,
    isVerified: true,
  },
  {
    id: "ev-005",
    marketId: "TRUMP-CONVICTION",
    source: "CNN",
    sourceType: "news",
    sourceCredibility: 0.85,
    url: "https://cnn.com/example",
    title: "Legal Experts: Conviction in Hush Money Case Likely But Not Certain",
    summary: "Legal analysts suggest that while prosecution has strong evidence, the novel legal theory could provide grounds for appeal, potentially delaying final conviction.",
    publishedAt: hoursAgo(8),
    direction: "NEUTRAL",
    strength: "MEDIUM",
    relevanceScore: 0.78,
    isVerified: true,
  },
  {
    id: "ev-006",
    marketId: "HOUSE-2024-GOP",
    source: "Cook Political Report",
    sourceType: "news",
    sourceCredibility: 0.93,
    url: "https://cookpolitical.com/example",
    title: "Cook Shifts 5 House Races Toward Republicans",
    summary: "The Cook Political Report has shifted 5 House races toward Republicans, citing redistricting advantages and Biden's approval rating impact on swing districts.",
    publishedAt: hoursAgo(12),
    direction: "YES",
    strength: "STRONG",
    relevanceScore: 0.94,
    author: "Amy Walter",
    isVerified: true,
  },
  {
    id: "ev-007",
    marketId: "GOV-SHUTDOWN-2024",
    source: "Politico",
    sourceType: "news",
    sourceCredibility: 0.88,
    url: "https://politico.com/example",
    title: "House GOP Hardliners Reject Latest Spending Proposal",
    summary: "A group of House Republican hardliners have rejected the latest bipartisan spending proposal, increasing odds of a government shutdown before the funding deadline.",
    publishedAt: hoursAgo(3),
    direction: "YES",
    strength: "STRONG",
    relevanceScore: 0.92,
    isVerified: true,
  },
  {
    id: "ev-008",
    marketId: "GOV-SHUTDOWN-2024",
    source: "@SpeakerJohnson",
    sourceType: "twitter",
    sourceCredibility: 0.8,
    url: "https://twitter.com/example",
    title: "Speaker Johnson: 'Optimistic about reaching a deal'",
    summary: "House Speaker Mike Johnson expressed optimism about reaching a spending deal, stating that negotiations are 'making progress' in closed-door meetings.",
    publishedAt: hoursAgo(5),
    direction: "NO",
    strength: "WEAK",
    relevanceScore: 0.75,
    author: "Mike Johnson",
    isVerified: true,
  },
  {
    id: "ev-009",
    marketId: "PRES-2024-WINNER",
    source: "Morning Consult",
    sourceType: "poll",
    sourceCredibility: 0.87,
    url: "https://morningconsult.com/example",
    title: "Latest Poll Shows Trump +2 Nationally",
    summary: "A new Morning Consult poll shows Trump leading Biden by 2 points nationally (47-45%), within the margin of error but representing a slight improvement for Trump.",
    publishedAt: hoursAgo(10),
    direction: "YES",
    strength: "WEAK",
    relevanceScore: 0.85,
    isVerified: true,
  },
  {
    id: "ev-010",
    marketId: "GA-2024-WINNER",
    source: "Atlanta Journal-Constitution",
    sourceType: "poll",
    sourceCredibility: 0.88,
    url: "https://ajc.com/example",
    title: "Georgia Poll: Trump Leads by 4 Points",
    summary: "A new AJC poll shows Trump leading Biden by 4 points in Georgia (49-45%), driven by increased support among suburban voters compared to 2020.",
    publishedAt: hoursAgo(14),
    direction: "YES",
    strength: "MEDIUM",
    relevanceScore: 0.91,
    isVerified: true,
  },
];

export const mockForecasts: Record<string, Forecast> = {
  "BIDEN-DROP-2024": {
    id: "fc-001",
    marketId: "BIDEN-DROP-2024",
    marketPrior: 0.15,
    modelPosterior: 0.22,
    confidence: "MEDIUM",
    edge: 0.07,
    edgeSignificant: true,
    recommendation: "BUY_YES",
    evidenceCount: 3,
    bullishCount: 2,
    bearishCount: 1,
    neutralCount: 0,
    whatChanged24h: "NYT report on senior Democrat concerns increased YES probability. Model now sees 7% edge vs market, driven by credible reporting on internal party discussions.",
    keyDrivers: [
      "NYT report on internal Democratic concerns (STRONG YES)",
      "Nate Silver analysis suggesting markets underpricing withdrawal",
      "Official Biden campaign denial (partially offsets)"
    ],
    generatedAt: hoursAgo(0.25),
    validUntil: hoursAgo(-1),
  },
  "TRUMP-CONVICTION": {
    id: "fc-002",
    marketId: "TRUMP-CONVICTION",
    marketPrior: 0.72,
    modelPosterior: 0.68,
    confidence: "HIGH",
    edge: -0.04,
    edgeSignificant: false,
    recommendation: "HOLD",
    evidenceCount: 2,
    bullishCount: 1,
    bearishCount: 0,
    neutralCount: 1,
    whatChanged24h: "Trial date confirmation is already priced in. Legal expert analysis suggests appeal risks create slight downside to conviction probability. Edge not significant enough for action.",
    keyDrivers: [
      "Trial date set for March 25 (priced in)",
      "Appeal risks on novel legal theory",
      "High market confidence already reflected"
    ],
    generatedAt: hoursAgo(0.5),
    validUntil: hoursAgo(-1),
  },
  "GOV-SHUTDOWN-2024": {
    id: "fc-003",
    marketId: "GOV-SHUTDOWN-2024",
    marketPrior: 0.35,
    modelPosterior: 0.42,
    confidence: "MEDIUM",
    edge: 0.07,
    edgeSignificant: true,
    recommendation: "BUY_YES",
    evidenceCount: 2,
    bullishCount: 1,
    bearishCount: 1,
    neutralCount: 0,
    whatChanged24h: "House GOP hardliner rejection of spending proposal significantly increased shutdown odds. Speaker's optimism appears performative given voting dynamics.",
    keyDrivers: [
      "House GOP hardliners reject bipartisan proposal (STRONG YES)",
      "Speaker Johnson optimism discounted as political positioning",
      "Deadline approaching with no viable path"
    ],
    generatedAt: hoursAgo(0.25),
    validUntil: hoursAgo(-1),
  },
};

// Helper functions
export function getMarketById(id: string): Market | undefined {
  return mockMarkets.find(m => m.id === id);
}

export function getEvidenceForMarket(marketId: string): Evidence[] {
  return mockEvidence.filter(e => e.marketId === marketId);
}

export function getForecastForMarket(marketId: string): Forecast | undefined {
  return mockForecasts[marketId];
}

export function formatCurrency(value: number): string {
  if (value >= 1_000_000) {
    return `$${(value / 1_000_000).toFixed(1)}M`;
  }
  if (value >= 1_000) {
    return `$${(value / 1_000).toFixed(0)}K`;
  }
  return `$${value}`;
}

export function formatPercent(value: number, decimals = 1): string {
  return `${(value * 100).toFixed(decimals)}%`;
}

export function formatEdge(edge: number): string {
  const sign = edge >= 0 ? "+" : "";
  return `${sign}${(edge * 100).toFixed(1)}%`;
}

export function getEdgeColor(edge: number): string {
  if (edge > 0.02) return "text-edge-positive";
  if (edge < -0.02) return "text-edge-negative";
  return "text-edge-neutral";
}

export function getConfidenceColor(confidence: Confidence): string {
  switch (confidence) {
    case "HIGH": return "text-strength-strong";
    case "MEDIUM": return "text-strength-medium";
    case "LOW": return "text-strength-weak";
  }
}
